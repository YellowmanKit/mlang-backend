{"version":3,"sources":["../../../src/main/routers/school.js"],"names":["SchoolRouter","app","init","mongoose","connect","db","connection","post","req","res","next","data","body","School","leaveSchool","result","leavedSchool","updatedProfile","json","joinSchool","joinedSchool","school","err","editedSchool","findOneAndUpdate","_id","$set","new","addSchool","newSchool","Router"],"mappings":";;;;;;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;AACA;;;;;;;;;;;;;;IAEMA,Y;;;AAEJ,wBAAYC,GAAZ,EAAgB;AAAA;;AAAA,4HACRA,GADQ;;AAEd,UAAKA,GAAL,GAAWA,GAAX;AACA,UAAKC,IAAL;AAHc;AAIf;;;;2BAEK;AAAA;;AACJ,UAAMD,MAAM,KAAKA,GAAjB;AACAE,yBAASC,OAAT,CAAiB,2BAAjB;AACA,UAAIC,KAAKF,mBAASG,UAAlB;;AAEAL,UAAIM,IAAJ,CAAS,eAAT;AAAA,2EAA0B,iBAAMC,GAAN,EAAWC,GAAX,EAAgBC,IAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAClBC,sBADkB,GACXH,IAAII,IAAJ,CAASD,IADE;AAExB;;AAEAE,mCAAOC,WAAP,CAAmBH,IAAnB,EAAyB,UAACI,MAAD,EAASC,YAAT,EAAuBC,cAAvB,EAAwC;AAC/D,2BAAOR,IAAIS,IAAJ,CAAS;AACdH,8BAAQA,MADM;AAEdC,oCAAcA,YAFA;AAGdC,sCAAgBA;AAHF,qBAAT,CAAP;AAKD,mBAND;;AAJwB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAA1B;;AAAA;AAAA;AAAA;AAAA;;AAaAhB,UAAIM,IAAJ,CAAS,cAAT;AAAA,4EAAyB,kBAAMC,GAAN,EAAWC,GAAX,EAAgBC,IAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AACjBC,sBADiB,GACVH,IAAII,IAAJ,CAASD,IADC;AAEvB;;AAEAE,mCAAOM,UAAP,CAAkBR,IAAlB,EAAwB,UAACI,MAAD,EAASK,YAAT,EAAuBH,cAAvB,EAAwC;AAC9D,2BAAOR,IAAIS,IAAJ,CAAS;AACdH,8BAAQA,MADM;AAEdK,oCAAcA,YAFA;AAGdH,sCAAgBA;AAHF,qBAAT,CAAP;AAKD,mBAND;;AAJuB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAzB;;AAAA;AAAA;AAAA;AAAA;;AAaAhB,UAAIM,IAAJ,CAAS,cAAT;AAAA,4EAAyB,kBAAMC,GAAN,EAAWC,GAAX,EAAgBC,IAAhB;AAAA;;AAAA;AAAA;AAAA;AAAA;AACjBW,wBADiB,GACRb,IAAII,IAAJ,CAASD,IADD;AAEvB;;AACIW,qBAHmB,WAGdC,YAHc;AAAA;AAAA,yBAIK,kBAAGV,iBAAOW,gBAAP,CAAwB,EAACC,KAAKJ,OAAOI,GAAb,EAAxB,EAA0C,EAAEC,MAAML,MAAR,EAA1C,EAA2D,EAAEM,KAAK,IAAP,EAA3D,CAAH,CAJL;;AAAA;AAAA;AAAA;AAItBL,qBAJsB;AAIjBC,8BAJiB;AAAA,oDAMhBd,IAAIS,IAAJ,CAAS;AACdH,4BAAQO,MAAK,QAAL,GAAe,SADT;AAEdC,kCAAcA;AAFA,mBAAT,CANgB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAzB;;AAAA;AAAA;AAAA;AAAA;;AAYAtB,UAAIM,IAAJ,CAAS,aAAT;AAAA,4EAAwB,kBAAMC,GAAN,EAAWC,GAAX,EAAgBC,IAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAChBC,sBADgB,GACTH,IAAII,IAAJ,CAASD,IADA;AAEtB;;AAEAE,mCAAOe,SAAP,CAAiBjB,IAAjB,EAAuB,UAACI,MAAD,EAASc,SAAT,EAAqB;AAC1C,2BAAOpB,IAAIS,IAAJ,CAAS;AACdH,8BAAQA,MADM;AAEdc,iCAAWA;AAFG,qBAAT,CAAP;AAID,mBALD;;AAJsB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAxB;;AAAA;AAAA;AAAA;AAAA;AAYD;;;;EA/DwBC,gB;;kBAmEZ9B,Y","file":"school.js","sourcesContent":["import Router from './Router';\r\nimport path from 'path';\r\nimport mongoose from 'mongoose';\r\nimport to from '../../to';\r\n\r\nimport User from '../../models/User.js';\r\nimport School from '../../models/School.js';\r\n\r\nclass SchoolRouter extends Router {\r\n\r\n  constructor(app){\r\n    super(app);\r\n    this.app = app;\r\n    this.init();\r\n  }\r\n\r\n  init(){\r\n    const app = this.app;\r\n    mongoose.connect('mongodb://localhost/mlang');\r\n    var db = mongoose.connection;\r\n\r\n    app.post('/school/leave', async(req, res, next)=>{\r\n      const data = req.body.data;\r\n      //console.log(data)\r\n\r\n      School.leaveSchool(data, (result, leavedSchool, updatedProfile)=>{\r\n        return res.json({\r\n          result: result,\r\n          leavedSchool: leavedSchool,\r\n          updatedProfile: updatedProfile\r\n        })\r\n      })\r\n    });\r\n\r\n    app.post('/school/join', async(req, res, next)=>{\r\n      const data = req.body.data;\r\n      //console.log(data)\r\n\r\n      School.joinSchool(data, (result, joinedSchool, updatedProfile)=>{\r\n        return res.json({\r\n          result: result,\r\n          joinedSchool: joinedSchool,\r\n          updatedProfile: updatedProfile\r\n        })\r\n      })\r\n    });\r\n\r\n    app.post('/school/edit', async(req, res, next)=>{\r\n      const school = req.body.data;\r\n      //console.log(data)\r\n      let err, editedSchool;\r\n      [err, editedSchool] = await to(School.findOneAndUpdate({_id: school._id},{ $set: school}, { new: true }));\r\n\r\n      return res.json({\r\n        result: err? 'failed': 'success',\r\n        editedSchool: editedSchool\r\n      })\r\n    });\r\n\r\n    app.post('/school/add', async(req, res, next)=>{\r\n      const data = req.body.data;\r\n      //console.log(data)\r\n\r\n      School.addSchool(data, (result, newSchool)=>{\r\n        return res.json({\r\n          result: result,\r\n          newSchool: newSchool\r\n        })\r\n      })\r\n    });\r\n\r\n  }\r\n\r\n}\r\n\r\nexport default SchoolRouter;\r\n"]}